<br />
<br />
<div fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="2%">
    <button mat-raised-button color="primary" (click)="toggleFormDialog()">New Happy Hour</button>
    <button mat-raised-button color="primary" (click)="toggleMap()">Toggle Map</button>
</div>
<br />
<mat-divider></mat-divider>
<mat-divider></mat-divider>
<br />
<ng-container *ngIf="happyHours$ | async as happyHours">
    <div fxLayout="column">
        <div *ngIf="showMap" fxFlex="100">
            <agm-map [zoom]="15" [gestureHandling]="'cooperative'"  [scrollwheel]="null" [latitude]='latitude' [longitude]='longitude'>
                <agm-marker *ngFor="let happyhour of happyHours" [latitude]="happyhour.latitude"
                    [longitude]="happyhour.longitude" [opacity]="1" [markerDraggable]="false"
                    (markerClick)="selectMarker($event,happyhour.name)">
                </agm-marker>
            </agm-map>
        </div>
        <div fxFlex="100" fxLayout.gt-xs="row wrap" fxLayout.xs="column"
                         fxLayoutAlign="start stretch" fxLayoutGap="2%">
            <mat-card [ngClass]="'hhCard'" fxLayout="column" fxFlex.xs="97" fxFlex.sm="45" fxFlex.md="31" fxFlex.lg="25"
                *ngFor="let happyhour of happyHours">
                <mat-card-header fxFlex>
                    <mat-card-title>{{happyhour.name}}</mat-card-title>
                    <mat-card-subtitle>{{happyhour.formattedAddress}}</mat-card-subtitle>
                </mat-card-header>
                <mat-card-content fxflex>
                    <mat-chip-list>
                        <ng-container *ngFor="let special of happyhour.todaysSpecials.specials; let i= index">
                            <mat-chip *ngIf="i < 4 && special.itemName !='' ">{{special.itemName}} </mat-chip>
                        </ng-container>
                    </mat-chip-list>
                </mat-card-content>
                <mat-card-actions fxFlexAlign="end" align="end">
                    <button mat-button (click)="editHappyHour(happyhour)">Edit</button>
                    <button mat-button (click)="deleteHappyHour(happyhour.name,happyhour._id)">Delete</button>
                </mat-card-actions>
            </mat-card>
        </div>

    </div>
</ng-container>
<ng-template #loading>
    <mat-progress-bar [mode]="indeterminate">
    </mat-progress-bar>
</ng-template>